---
title: 图灵机器人接口开发
date: 2018-12-28 13:32:53
categories: Android
---
&emsp;&emsp;到图灵机器人官网(`http://www.turingapi.com/#/platfrom`)注册一个账号，根据自己需求创建一个机器人。创建完成之后，会得到一个`APIkey`和`secret`，并下载`Android SDK`，`libs`文件夹里有我们需要的`jar`包。
&emsp;&emsp;新建一个项目，将`libs`文件夹里面的`volley.jar`和`turingSDK.jar`放到工程的`libs`目录中，其他的`jar`包是语音相关的，这里暂时先不管。
&emsp;&emsp;给`AndroidMainfest.xml`添加如下权限：

``` xml
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.READ_PHONE_STATE" />
```

图灵机器人返回结果的数据格式为：

``` json
{
    "code": 200000,
    "text": "亲，已帮你找到图片",
    "url": "http://m.image.so.com/i?q=%E5%B0%8F%E7%8B%97"
}
```

&emsp;&emsp;`MainActivity.java`代码如下：

``` java
package com.example.fukangwei.myapplication;
​
import android.support.v7.app.AppCompatActivity;
import android.os.Bundle;
​
import com.turing.androidsdk.HttpRequestListener;
import com.turing.androidsdk.TuringManager;
​
import org.json.JSONException;
import org.json.JSONObject;
​
import android.widget.Toast;
​
public class MainActivity extends AppCompatActivity {
    /* 申请的turing的apikey */
    private final String TURING_APIKEY = "31c05767690747ffb52912f2f4793609";
    private final String TURING_SECRET = "dff37ad6eaa3290d";
    TuringManager mTuringManager;
​
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        init();
        mTuringManager.requestTuring("我爱你");
    }
​
    private void init() {
        mTuringManager = new TuringManager(MainActivity.this, TURING_APIKEY, TURING_SECRET);
        mTuringManager.setHttpRequestListener(myHttpConnectionListener);
    }
​
    HttpRequestListener myHttpConnectionListener = new HttpRequestListener() {
        @Override
        public void onSuccess(String s) {
            if (s != null) {
                try {
                    JSONObject result_obj = new JSONObject(s);
                    if (result_obj.has("text")) {
                        Toast.makeText(MainActivity.this, result_obj.get("text").toString(), Toast.LENGTH_SHORT).show();
                    }
                } catch (JSONException e) {
                    Toast.makeText(MainActivity.this, "JSONException: " + e.getMessage(), Toast.LENGTH_SHORT).show();
                }
            }
        }
​
        @Override
        public void onFail(int i, String s) {
            Toast.makeText(MainActivity.this, "onFail code: " + i + " | error: " + s, Toast.LENGTH_SHORT).show();
        }
    };
}
```