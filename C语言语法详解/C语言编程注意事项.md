---
title: C语言编程注意事项
categories: C语言语法详解
date: 2018-12-06 12:33:00
---
1. 注意，可执行文件一定不要和目录使用同一个名字。<!--more-->
2. 函数名与对函数名进行取地址是一样的，都表示函数的地址。
3. 在打印`unsigned long`数据类型时，使用的格式为`%ld`；打印`unsigned long long`时，使用的格式是`%lld`。
4. `typedef`用来定义一个变量类型的别名；`static`不是变量类型，它定义存放方式。因此，`typedef static u8 STATIC`是错误的，编译器会报错`more than one storage class specified`。
5. 关键字`long`的大小表示机器的字节长度，如`32`位机器为`4`个字节，`64`位机器为`8`个字节。
6. `C`语言标准并没有要求用补码形式来表示有符号整数，但是几乎所有机器都是这么做的。
7. 在进行除法运算时，一定要注意结果的正确性！例如，`-7/2`的结果为`-3`，而不是`-4`。对于除于`2`的幂，无符号和补码分别使用逻辑移位和算术移位来达到目的。
8. 使用`sprintf`或`printf`格式化数据时，格式化字符串的形式要和格式化的变量一一对应，例如使用`%d`对`char`型变量进行格式会造成误差，解决方法是将`char`型变量强制转换为`int`型。
9. 在代码中，一定要声明变量的类型是`signed`型还是`unsigned`型，例如这样的代码`for( char i = 7; i >= 0; i-- )`。
10. 把`C`语言代码放在多个文件中的编译速度要比只放在一个文件上要快。
11. 运行代码有时候不能立即出现结果，其原因有可能是算法的效率很低，需要对算法进行改进。
12. 对于无定义的特性，要么应该将其从程序中消去。
13. 关心局部效率是不值得的，如果你很注重效率的话，请集中于全局效率和算法的效率上，这样你才会看到努力的效果。
14. 在多重循环中，应将最忙的循环放在最内层，这样可以减少`CPU`切入循环层的次数，提高运行效率。
15. 尽量用乘法或其它方法代替除法，特别是浮点运算中的除法，因为浮点运算除法要占用较多`CPU`资源。
16. `if`语句尽量加上`else`分支，对没有`else`分支的语句要小心对待；`switch`语句必须有`default`分支，要考虑代码运行时可能会出现的所有情况。
17. 在编译器中设置全局宏定义要优于在代码配置文件中设置宏定义。
18. 程序必须为阅读它的人而编写，只是顺便用于机器执行。
19. 一个函数应该仅完成一个功能，实现多个功能将会给开发、使用以及维护都带来很大困难，`realloc`是个反面教材。
20. `argv`数组的最后一个元素为`NULL`，因此可以用`NULL`来判断是否读到最后一个元素。
21. 使用`free`或`delete`释放内存后，必须要将该指针设置为`NULL`，避免产生野指针。
22. 可以利用传递结构体指针的方式来编写有多个返回值的`C`语言函数。
23. 使用`strcpy`函数将一个字符串复制到一个数组后，不要忘记将数组中字符串的后面加上`\0`。
24. 如果两个指针指向同一个数组，它们就可以相减，其结果为两个指针之间的元素数目。
25. 对于`C`语言的科学计数法，`12.3E12`表示`12.3 * 10^12`，注意`E`和左右两边的数字之间不要有间隔。
26. `volatile const`这种类型是允许的，它表示其后面定义的变量是只读的，比如用它来定义一个只读的状态寄存器。定义为`volatile`是因为它的值可能会被硬件意想不到地改变，而定义为`const`是因为程序不应该试图去修改它的值。
27. 输入输出流有`缓冲流`和`非缓冲流`之分：对于`非缓冲流`，一旦数据送到缓冲区，立即处理；对于缓冲流，仅当缓冲区满或当前送入的数据为新的一行字符时，系统才对流中的数据进行处理(称为`刷新`)。通常使用缓冲流，仅在特殊场合，才使用非缓冲流。
28. 对于向`main`函数传参数的程序，如果没有传入个数或者类型正确的参数，代码也会报出段错误。
29. `fclose`函数隐含执行了一次`fflush`操作，所以不必在调用`fclose`之前调用`fflush`。
30. 在使用指针前，一定要考虑该指针是否指向了合适的内存空间。
31. 使用`const`定义常量从汇编的角度来看，只是给出了对应的内存地址，而不是像`#define`一样给出的是立即数。所以`const`定义的常量在程序运行过程中只有一份拷贝，而`#define`定义的常量在内存中有若干个拷贝。
32. 即便函数没有参数，最好也要加上`void`关键字，否则编译器会报出`function declaration isn't a prototype`的警告。