---
title: fdopen函数
categories: C语言语法详解
date: 2018-12-10 21:31:39
---
&emsp;&emsp;`fdopen`取一个现存的文件描述符，并使一个标准的`I/O`流与该描述符相结合：<!--more-->

``` cpp
#include <stdio.h>
FILE* fdopen ( int fildes, const char* mode );
```

`fdopen`会将参数`fildes`对应的文件描述符转换为对应的文件指针后返回。
&emsp;&emsp;参数`mode`代表文件指针的流形态，此形态必须和原先文件描述符读写模式相同。`mode`有下列几种形态字符串：

- `r`：打开只读文件，该文件必须存在。
- `r+`：打开可读写的文件，该文件必须存在。
- `w`：打开只写文件，若文件存在，则文件长度清为`0`，即该文件内容会消失。若文件不存在，则建立该文件。
- `w+`：打开可读写文件，若文件存在，则文件长度清为`0`，即该文件内容会消失。若文件不存在，则建立该文件。
- `a`：以附加的方式打开只写文件。若文件不存在，则会建立该文件；如果文件存在，写入的数据会被加到文件尾。
- `a+`：以附加方式打开可读写的文件。若文件不存在，则会建立该文件；如果文件存在，写入的数据会被加到文件尾后。

&emsp;&emsp;如果函数执行成功，则返回指向该流的文件指针；如果函数执行失败，则返回`NULL`，并把错误代码存在`errno`中。

``` cpp
#include <stdio.h>

int main() {
    FILE* fp = fdopen ( 1, "w+" );
    fprintf ( fp, "%s\n", "hello!" );
    fclose ( fp );
}
```

执行结果：

``` bash
hello!
```