---
title: printf输出
date: 2018-12-13 15:32:18
categories: C语言语法详解
---
### printf输出格式

&emsp;&emsp;`printf`格式控制如下：

``` bash
% - 0 m.n l或h 格式字符
```

下面对组成格式的各项进行说明：

格式     | 说明
---------|------
`%`      | 表示格式说明的起始符号，不可缺少
`-`      | 有`-`表示左对齐输出，如果省略表示右对齐输出
`0`      | 有`0`表示指定空位填`0`，如果省略表示指定空位不填
`m.n`    | `m`指域宽，即对应的输出项在输出设备上所占的字符数；`n`指精度，用于说明输出的实型数的小数位数。未指定`n`时，隐含的精度为`n = 6`位
`l`或`h` | `l`对整型指`long`型，对实型指`double`型；`h`用于将整型的格式字符修正为`short`型

举例如下：

- `%-md`：左对齐，若`m`比实际少时，按实际输出。
- `%m.ns`：输出`m`位，取字符串(左起)`n`位，左补空格。当`n > m`或`m`省略时，`m = n`(例如`%7.2s`输入`CHINA`，输出`(5个空格)CH`。
- `%m.nf`：输出浮点数，`m`为宽度，`n`为小数点右边数位。

&emsp;&emsp;格式字符如下：
&emsp;&emsp;1. `d格式`：用来输出十进制整数。有以下几种用法：

- `%d`：按整型数据的实际长度输出。
- `%md`：`m`为指定的输出字段的宽度。如果数据的位数小于`m`，则左端补以空格；若大于`m`，则按实际位数输出。
- `%ld`：输出长整型数据。

&emsp;&emsp;2. `o格式`：以无符号八进制形式输出整数。对长整型可以用`%lo`格式输出，可以用`%mo`格式指定输出字段宽度。例如：

``` cpp
int main() {
    int a = -1;
    printf ( "%d, %o", a, a );
}
```

执行结果为`-1,177777`。`-1`在内存单元中(以补码形式存放)为`2`(`1111111111111111`)，转换为八进制数为`8`(`177777`)。
&emsp;&emsp;3. `x格式`或`%X`：以无符号十六进制形式输出整数。对长整型可以用`%lx`格式输出，可以用`%mx`格式指定输出字段宽度。
&emsp;&emsp;4. `u格式`：以无符号十进制形式输出整数。对长整型可以用`%lu`格式输出，可以用`%mu`格式输出指定字段宽度。
&emsp;&emsp;5. `c格式`：输出一个字符。
&emsp;&emsp;6. `s格式`：用来输出一个字符串。有如下几种用法：

- `%s`：例如`printf("%s", "CHINA")`输出`CHINA`字符串(不包括双引号)。
- `%ms`：输出的字符串占`m`列，如字符串本身长度大于`m`，则突破获`m`的限制，将字符串全部输出。若串长小于`m`，则左补空格。
- `%-ms`：如果串长小于`m`，则在`m`列范围内，字符串向左靠，右补空格。
- `%m.ns`：输出占`m`列，但只取字符串中左端`n`个字符。这`n`个字符输出在`m`列的右侧，左补空格。注意，如果`n`未指定，默认为`0`。
- `%-m.ns`：其中`m`、`n`含义同上，`n`个字符输出在`m`列范围的左侧，右补空格。如果`n > m`，则自动取`n`值，即保证`n`个字符正常输出。注意，如果`n`未指定，默认为`0`。如果是`sprintf(desc, "%m.ns", sour)`，假如`desc`空间够的话，会在`%m.ns`串的结尾自动补`nul`字符，不同于`strncpy`。例如`sprintf(desc, "%.3s", "123456")`，如果`desc`空间大于`4`字节的话，第`4`个字节将是`nul`字符。

&emsp;&emsp;7. `f格式`：用来输出实数(包括单、双精度)，以小数形式输出。有以下几种用法：

- `%f`：不指定宽度，整数部分全部输出并输出`6`位小数。
- `%m.nf`：输出共占`m`列，其中有`n`位小数，如果数值宽度小于`m`，则左端补空格。
- `%-m.nf`：输出共占`n`列，其中有`n`位小数，如果数值宽度小于`m`，则右端补空格。

&emsp;&emsp;8. `e格式`或`%E`：以指数形式输出实数。有以下几种用法：

- `%e`：数字部分(又称`尾数`)输出`6`位小数，指数部分占`5`位或`4`位。
- `%m.ne`和`%-m.ne`：`m`、`n`和`-`字符含义与前面相同。此处`n`指数据的数字部分的小数位数，`m`表示整个输出数据所占的宽度。

&emsp;&emsp;9. `g格式`或`%G`：自动选`f`格式或`e`格式中较短的一种输出，且不输出无意义的`0`。

### printf输出数字补0

&emsp;&emsp;代码如下：

``` cpp
int a = 4;
printf ( "%03d", a ); /* 输出“004” */
```

也可以用`*`代替位数，在后面的参数列表中用变量控制输出位数：

``` cpp
int a = 4;
int n = 3;
printf ( "%0*d", n, a ); /* 输出“004” */
```

### printf格式化short类型

&emsp;&emsp;从`printf`函数原理来说，函数根据前面的格式字符串来强硬转换后面的参数，比如遇到`%d`，就表示要将参数强制转换为`int`型。如果你传入的参数是`short`型，`short`型只要`2`个字节，那么强制转换为`int`(`4`个字节)，是不是就会出错呢？你可以试试看，完全没有错。
&emsp;&emsp;函数的参数每一个最少要占一个计算机位长(因为参数要压栈)，所以`short`型参数压栈时已经扩展为`4`个字节了(`32`位`cpu`)，所以即使用`char`型当整数输出也是可以的。例如：

``` c
printf ( "%d", ( short ) 90 ); /* 输出90 */
printf ( "%d", 'Y' ); /* 输出89 */
```

其实也可以用`%hd`来输出`short`类型。`%hd`是格式字符串，用于`short`类型的格式化输入输出，十进制且有符号。`h`与`l`相对应，加`h`修饰用于`short`系列，加`l`修饰用于`long`系列。一般教科书不提`%hd`，是因为以前`int`是`16`位的，与`short`一样，`short`用`%d`就可以了。可是现在`int`是`32`位的，应用到`16`位的`short`时就必须用`%hd`了。