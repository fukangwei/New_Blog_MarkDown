---
title: 回调函数
categories: Node.js笔记
abbrlink: a03e68d3
date: 2019-02-08 13:05:03
---
&emsp;&emsp;同步是指一个时刻仅有一件事件在执行，异步指一个时刻可以有多个事件同时执行，`Node.js`异步编程的直接体现就是回调。异步编程依托于回调来实现，但不能说使用了回调后程序就异步化了。
&emsp;&emsp;`Node.js`使用了大量的回调函数，其所有`API`都支持回调函数，例如我们可以一边读取文件，一边执行其他命令。在文件读取完成后，我们将文件内容作为回调函数的参数返回。这样在执行代码时，就没有阻塞或等待文件`I/O`操作，大大提高了`Node.js`的性能，可以处理大量的并发请求。
&emsp;&emsp;回调函数一般作为参数的最后一个参数出现：

``` javascript
function foo1(name, age, callback) { }
function foo2(value, callback1, callback2) { }
```

### 阻塞代码

&emsp;&emsp;创建`input.txt`：

``` javascript
菜鸟教程官网地址：www.runoob.com
```

创建`main.js`：

``` javascript
var fs = require("fs");
var data = fs.readFileSync('input.txt');
console.log(data.toString());
console.log("程序执行结束!");
```

执行结果：

``` javascript
菜鸟教程官网地址：www.runoob.com
程序执行结束!
```

### 非阻塞代码

&emsp;&emsp;创建`input.txt`：

``` javascript
菜鸟教程官网地址：www.runoob.com
```

创建`main.js`：

``` javascript
var fs = require("fs");
​
fs.readFile('input.txt', function(err, data) {
    if (err) return console.error(err);
    console.log(data.toString());
});
​
console.log("程序执行结束!");
```

执行结果：

``` javascript
程序执行结束!
菜鸟教程官网地址：www.runoob.com
```

以上两个实例让我们了解阻塞与非阻塞调用的不同：第一个实例在文件读取完后才执行完程序；第二个实例不需要等待文件读取完，这样就可以在读取文件的同时执行接下来的代码，大大提高了程序的性能。因此，阻塞是按顺序执行的，而非阻塞是不需要按顺序的。所以如果需要处理回调函数的参数，我们就需要写在回调函数内。