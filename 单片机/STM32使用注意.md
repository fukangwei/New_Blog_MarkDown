---
title: STM32使用注意
categories: 单片机
date: 2019-01-19 11:19:55
---
1. 首先确保`boot0`和`boot1`接地，否则系统无法启动。<!--more-->
2. `STM32`的大小端和具体的芯片系列有关。如果是`STM32F101xx`和`STM32F103xx`的话，仅支持小端模式，虽然`Cortex-M3`是大小端都支持的。可以在下载代码时通过编译器来看出`STM32`芯片是大端模式还是小端模式。
3. 在修改程序的时候，要把不需要的头文件全部删除，以免留下后患，同时也是为了更强的移植性。写好的程序尽量用全部编译。
4. 在`fat16`文件系统支持长文件名后，不仅支持`.`前面的长文件名，还支持`.`后面的长后缀名。
5. `stm32`的`GPIOA`和`GPIOB`引脚有几个是与`JTAG`相关的，若要使用的话，要在适当的位置关闭`JTAG`功能。
6. 即使集成以太网控制器，`STM32F107`和`STM32F407`也只有`MAC`部分，需要额外的`PHY`芯片。`ENC28J60`是一个完整的以太网控制器，包含`MAC`和`PHY`。
7. 把`51`单片机的驱动程序或应用程序移植到`stm32`时，`int`型最好改为`short`型，因为`51`的`int`和`stm32`的`short`都是`16`位。
8. `STM32`的`I/O`端口复位后处于浮空状态，也就是其电平状态由外围电路决定。
9. `STM32`的`GPIO`输出电压为`3.3V`，而不是`5V`。`STM32`部分`IO`口可以容忍`5V`，部分`IO口`只能容忍`3.3V`。查看数据手册，引脚标注`FT`的引脚可以容忍`5V`。如果要`IO`口输出`5V`的电压，解决办法就是将能容忍`5V`的`IO`口的模式配置成`开漏输出`，然后在外部接上拉`5V`的电源；或者是用引脚输出的`3.3V`控制一个三极管输出`5V`。
10. 下载之后即可重启开发板的方法：在`Flash Download`选项中勾选`Reset and Run`。
11. `Keil for ARM`生成的程序如果在下载之后出现问题，考虑一下多下载几次。当`51`单片机出现这种情况时，也可以用这种方法来解决。
12. 当`STM32`的引脚被设置为`GPIO_Mode_IN_FLOATING`模式时，它可以直接使用位带的`Pin`和`Pout`功能，无需进行输入和输出模式的转换。
13. `STM32`的`for`循环语句可以这样使用：`for(int i = 0; i < num; i++)`，不过需要将编译器设置为`C99`模式，将`_sys_exit`的返回值设置为`void`(在`keil for ARM`中)。
14. `STM32`单片机最好使用模拟`IIC`代码，硬件`IIC`代码不好用，貌似存在`BUG`。
15. 如果`stm32`工程中包含`C`源文件与汇编文件，尽量使用`Rebuild`(`Rebuild all target files`)。