---
title: 作用域
date: 2018-12-27 18:57:00
categories: Python语法
---
### 块级作用域

&emsp;&emsp;想想下面的程序会执行成功吗？

``` python
if 1 == 1:
    name = "lzl"
​
print(name)
# ----------------
for i in range(10):
    age = i
​
print(age)
```

执行结果：

``` bash
lzl
9
```

代码执行成功，没有问题，但是在`Java`或`C#`中，执行上面的代码会提示`name`和`age`没有定义。这是因为在`Python`中是没有块级作用域的，外部可以调用代码块中的变量。

### 局部作用域

&emsp;&emsp;回顾之前学过的知识，我们学习函数的时候，函数是个单独的作用域，`Python`中没有块级作用域，但是有局部作用域：

``` python
def func():
    name = "lzl"
​
print(name)
```

执行结果：

``` bash
NameError: name 'name' is not defined
```

`name`的作用域也只是在函数内部，外部无法进行调用。

### 作用域链

&emsp;&emsp;对函数做下调整：

``` python
name = "lzl"
​
def f1():
    name = "Eric"
​
    def f2():
        name = "Snor"
        print(name)
​
    f2()
​
f1()
```

学过函数肯定知道，最后`f1`执行完会输出`Snor`。先记住一个概念：`Python`中有作用域链，变量会由内到外找，先去自己作用域去找，自己没有再去上级去找，直到找不到报错。

### 终极版作用域

&emsp;&emsp;终极版如下：

``` python
name = "lzl"
​
def f1():
    print(name)
​
def f2():
    name = "eric"
    f1()
​
f2()
```

现在先不把答案贴出来，先看看下面这段代码：

``` python
name = "lzl"
​
def f1():
    print(name)
​
def f2():
    name = "eric"
    return f1
​
ret = f2()
ret()  # 输出“lzl”
```

分析上面的代码，`f2`执行结果为函数f1的内存地址，即`ret = f1`，执行`ret`等同于执行`f1`。执行`f1`时与`f2`没有任何关系，`name = "lzl"`与`f1`在一个作用域链，函数内部没有变量是会向外找，所以此时变量`name`值为`lzl`。